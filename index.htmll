<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Presence Digital - Organizador de Serviços</title>
  <style>
    :root{
      --bg:#071226; /* dark navy */
      --card:#0b2a47;
      --accent:#1e90ff;
      --muted:#9fb6d6;
      --glass: rgba(255,255,255,0.03);
      --round:12px;
      font-family: Inter, system-ui, Arial, sans-serif;
    }
    *{box-sizing:border-box}
    body{
      margin:0;min-height:100vh;background:linear-gradient(180deg,var(--bg),#031028);color:#e6f0ff;padding:28px;
      -webkit-font-smoothing:antialiased;
    }
    header{max-width:1100px;margin:0 auto 18px;display:flex;align-items:center;gap:16px}
    .logo{width:64px;height:64px;border-radius:12px;background:linear-gradient(135deg,var(--accent),#004e92);display:flex;align-items:center;justify-content:center;font-weight:700;color:#fff;font-size:18px}
    h1{margin:0;font-size:20px}
    p.lead{margin:0;color:var(--muted);font-size:13px}

    .wrap{max-width:1100px;margin:12px auto;display:grid;grid-template-columns:1fr 420px;gap:18px}
    .panel{background:linear-gradient(180deg,var(--card),rgba(5,20,40,0.6));padding:18px;border-radius:var(--round);box-shadow:0 6px 18px rgba(2,8,20,0.6);}

    label{display:block;font-size:13px;margin-bottom:6px;color:var(--muted)}
    input[type=text],input[type=number],textarea,select{width:100%;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);background:var(--glass);color:inherit}
    textarea{min-height:74px;resize:vertical}
    .btn{display:inline-block;padding:10px 12px;border-radius:10px;background:var(--accent);color:#fff;border:none;cursor:pointer;font-weight:600}
    .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06)}
    .row{display:flex;gap:10px}

    .summary{display:flex;gap:12px;margin-bottom:12px}
    .tile{flex:1;padding:12px;border-radius:10px;background:rgba(255,255,255,0.02);text-align:center}
    .tile strong{display:block;font-size:18px}
    .list{max-height:560px;overflow:auto;padding-top:6px}
    table{width:100%;border-collapse:collapse;font-size:14px}
    th,td{padding:8px 10px;text-align:left;border-bottom:1px solid rgba(255,255,255,0.03)}
    .paid{color:#7ee787;font-weight:700}
    .unpaid{color:#ff8b8b;font-weight:700}
    small.muted{color:var(--muted)}

    footer{max-width:1100px;margin:20px auto;color:var(--muted);font-size:13px}

    @media(max-width:980px){.wrap{grid-template-columns:1fr}header{justify-content:center} .logo{display:none}}
  </style>
</head>
<body>
  <header>
    <div class="logo">PD</div>
    <div>
      <h1>Presence Digital</h1>
      <p class="lead">Organize clientes, serviços e pagamentos — pronto para subir ao GitHub (arquivo único: index.html).</p>
    </div>
  </header>

  <main class="wrap">
    <section class="panel">
      <h2 style="margin-top:0">Novo serviço</h2>
      <label>Nome do cliente</label>
      <input id="cliente" type="text" placeholder="Ex: João Silva" />

      <label>Serviço</label>
      <textarea id="servico" placeholder="Descreva o serviço..."></textarea>

      <div class="row">
        <div style="flex:1">
          <label>Valor (R$)</label>
          <input id="valor" type="number" placeholder="150" />
        </div>
        <div style="width:140px">
          <label>Pagamento</label>
          <select id="pagamento">
            <option value="nao_pago">Não pago</option>
            <option value="pago">Pago</option>
          </select>
        </div>
      </div>

      <div style="display:flex;gap:8px;margin-top:8px">
        <button class="btn" onclick="adicionar()">Salvar</button>
        <button class="btn ghost" onclick="limparCampos()">Limpar</button>
        <button class="btn ghost" onclick="exportarCSV()">Exportar CSV</button>
      </div>

      <hr style="border:none;height:1px;background:rgba(255,255,255,0.03);margin:12px 0" />

      <div class="summary">
        <div class="tile"><small class="muted">Total serviços</small><strong id="total">0</strong></div>
        <div class="tile"><small class="muted">Pendentes</small><strong id="pendentes">0</strong></div>
        <div class="tile"><small class="muted">Recebido (R$)</small><strong id="recebido">0</strong></div>
      </div>

      <label>Filtrar</label>
      <div style="display:flex;gap:8px;margin-bottom:8px">
        <select id="filtro" onchange="carregar()">
          <option value="todos">Todos</option>
          <option value="pago">Pagos</option>
          <option value="nao_pago">Não pagos</option>
        </select>
        <input id="busca" type="text" placeholder="Buscar por cliente ou serviço" oninput="carregar()" />
      </div>

      <div class="list">
        <table>
          <thead><tr><th>Cliente</th><th>Serviço</th><th>Valor</th><th>Pagamento</th><th></th></tr></thead>
          <tbody id="lista"></tbody>
        </table>
      </div>
    </section>

    <aside class="panel">
      <h3 style="margin-top:0">Dicas rápidas</h3>
      <p class="muted">1. Salve frequentemente. Os dados ficam no seu navegador (localStorage).</p>
      <p class="muted">2. Para publicar no GitHub: crie repositório novo e coloque este arquivo como <b>index.html</b>.</p>
      <p class="muted">3. Para acessar de qualquer lugar, ative <b>GitHub Pages</b> nas configurações do repositório (branch: main / root).</p>

      <hr style="border:none;height:1px;background:rgba(255,255,255,0.03);margin:12px 0" />

      <h4>Exportar / Limpar</h4>
      <button class="btn ghost" style="width:100%" onclick="confirmLimpar()">Apagar todos os serviços</button>
    </aside>
  </main>

  <footer>
    Presence Digital • Desenvolvido para Lumini / uso pessoal
  </footer>

  <script>
    // armazenamento simples em localStorage
    function carregar(){
      const dados = JSON.parse(localStorage.getItem('pd_servicos')||'[]');
      const filtro = document.getElementById('filtro').value;
      const busca = document.getElementById('busca').value.toLowerCase();
      const listaEl = document.getElementById('lista');
      listaEl.innerHTML = '';

      let total = 0, pendentes = 0, recebido = 0;

      dados.forEach((d, i) => {
        if(filtro!=='todos' && d.pagamento !== filtro) return;
        if(busca && !(d.cliente.toLowerCase().includes(busca) || d.servico.toLowerCase().includes(busca))) return;

        total++;
        if(d.pagamento==='nao_pago') pendentes++;
        if(d.pagamento==='pago') recebido += Number(d.valor || 0);

        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${escapeHtml(d.cliente)}</td>
          <td><small class="muted">${escapeHtml(d.servico)}</small></td>
          <td>R$ ${Number(d.valor).toFixed(2)}</td>
          <td class="${d.pagamento==='pago'?'paid':'unpaid'}">${d.pagamento==='pago'?'Pago':'Não pago'}</td>
          <td style="text-align:right">
            <button class="btn ghost" onclick="editar(${i})">Editar</button>
            <button class="btn ghost" onclick="deletar(${i})">Excluir</button>
            <button class="btn ghost" onclick="togglePago(${i})">Toggle Pag.</button>
          </td>`;
        listaEl.appendChild(tr);
      });

      document.getElementById('total').textContent = total;
      document.getElementById('pendentes').textContent = pendentes;
      document.getElementById('recebido').textContent = 'R$ ' + recebido.toFixed(2);
    }

    function adicionar(){
      const cliente = document.getElementById('cliente').value.trim();
      const servico = document.getElementById('servico').value.trim();
      const valor = document.getElementById('valor').value.trim();
      const pagamento = document.getElementById('pagamento').value;
      if(!cliente || !servico || !valor){alert('Preencha nome, serviço e valor.');return}
      const dados = JSON.parse(localStorage.getItem('pd_servicos')||'[]');
      dados.push({cliente,servico,valor,pagamento});
      localStorage.setItem('pd_servicos',JSON.stringify(dados));
      limparCampos();carregar();
    }
    function limparCampos(){document.getElementById('cliente').value='';document.getElementById('servico').value='';document.getElementById('valor').value='';document.getElementById('pagamento').value='nao_pago'}

    function deletar(index){
      const dados = JSON.parse(localStorage.getItem('pd_servicos')||'[]');
      if(confirm('Excluir este serviço?')){dados.splice(index,1);localStorage.setItem('pd_servicos',JSON.stringify(dados));carregar()}
    }

    function editar(index){
      const dados = JSON.parse(localStorage.getItem('pd_servicos')||'[]');
      const d = dados[index];
      if(!d) return;
      document.getElementById('cliente').value = d.cliente;
      document.getElementById('servico').value = d.servico;
      document.getElementById('valor').value = d.valor;
      document.getElementById('pagamento').value = d.pagamento;
      // remove original item
      dados.splice(index,1);
      localStorage.setItem('pd_servicos',JSON.stringify(dados));
      carregar();
    }

    function togglePago(index){
      const dados = JSON.parse(localStorage.getItem('pd_servicos')||'[]');
      if(!dados[index]) return;
      dados[index].pagamento = dados[index].pagamento==='pago' ? 'nao_pago' : 'pago';
      localStorage.setItem('pd_servicos',JSON.stringify(dados));carregar();
    }

    function exportarCSV(){
      const dados = JSON.parse(localStorage.getItem('pd_servicos')||'[]');
      if(!dados.length){alert('Nenhum dado para exportar.');return}
      const cab = ['Cliente','Servico','Valor','Pagamento'];
      const rows = dados.map(r => [r.cliente.replace(/"/g,'""'), r.servico.replace(/"/g,'""'), r.valor, r.pagamento]);
      const csv = [cab.join(','), ...rows.map(r=>'"'+r.join('","')+'"')].join('\n');
      const blob = new Blob([csv],{type:'text/csv;charset=utf-8;'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');a.href=url;a.download='presence_digital_servicos.csv';document.body.appendChild(a);a.click();a.remove();URL.revokeObjectURL(url);
    }

    function confirmLimpar(){
      if(confirm('Apagar todos os serviços armazenados? Esta ação não pode ser desfeita.')){localStorage.removeItem('pd_servicos');carregar()}
    }

    function escapeHtml(str){return String(str).replace(/[&<>\"']/g, function(s){return {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;"}[s]})}

    // inicializa
    carregar();
  </script>
</body>
</html>
